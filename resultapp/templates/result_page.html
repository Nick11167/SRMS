{% extends "base.html" %}

{% block content %}
<div class="container py-5" id="example">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow  mb-5 bg-white rounded">
                <div class="card-header text-center bg-dark text-white py-2">
                    <h4><i class="fas fa-graduation-cap"></i> Student Result Details </h4>
                </div>
                <div class="card-body p-4">
                    {% if messages %}
                        {% for m in messages %}
                     <div class="alert alert-{% if m.tags == 'error'%}danger{% else %}{{m.tags}}{% endif %} alert-dismissible fade show" role="alert">
                            {{m}}
                     <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                         {% endfor %}
                    {% endif %}
                    <p><strong>Student Name:</strong> {{student.name}}</p>
                    <p><strong>Roll No.:</strong> {{student.roll_number}}</p>
                    <p><strong>Class:</strong> {{student.student_class.yearStream}} {{student.student_class.streamName}}</p>

                    {% if results %}
                        <table class="table table-bordered mt-4 text-center">
                            <thead>
                                <tr>
                                    <th>Sr.no.</th>
                                    <th>Subject</th>
                                    <th>Marks</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for r in results %}
                                <tr>
                                    <td>{{forloop.counter}}</td>
                                    <td>{{r.subject.subject_name}}</td>
                                    <td>{{r.marks}}</td>
                                </tr>
                                {% endfor %}
                                <tr>
                                    <th colspan="2">Total Marks</th>
                                    <td><b>{{ total_marks }}</b> out of <b>{{ max_total }}</b></td>
                                </tr>

                                <tr>
                                    <th colspan="2">Percentage</th>
                                    <td><b>{{ percentage }}%</b></td>
                                </tr>
                            </tbody>
                            <tr>
                                <td colspan="3">
                                    <i class="fas fa-print fa-2x" style="cursor:pointer" onclick="printResult()"></i>
                                </td>
                            </tr>
                        </table>
                    {% else %}
                        <div class="alert alert-warning text-center" role="alert">
                            Your Result is not declared yet. Please contact to the administrator.
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function printResult(){
        var content = document.getElementById('example').innerHTML;
        var win = window.open("", "", "width=900,height=900");
        win.document.write("<html><head><title>Print Result</title>");
        win.document.write('<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">');
        win.document.write('<style>@media print{body {-webkit-print-color-adjust : exact}}</style>');
        win.document.write('</head><body>'); 
        win.document.write(content);
        win.document.write('</body></html>');
        win.document.close();
        win.print();
    }
</script>
{% endblock  %}